import{_ as T,D as c,S as f,o as l,c as m,a as i,t as d,F as h,f as v,p as S,j as _,g as E,n as D}from"./index.851b8603.js";const b=[["Curiosity","Palace Green Ware","Sea Fishing"],[null,"Scholar's Debate","Alliance Carnival"],["Intimacy","Penglai Island Domination","Jade for Beauty"],["Savvy","Mohist Maze","Palace Cuju"],["Power","Siege","Elite Drill"],["Curiosity","Loulan Dominion",null],[null,"Naadam Fair","Imperial Feast"],["Intimacy","Penglai Island Domination","Jade for Beauty"],["Savvy","Go Match","Palace Cuju"],["Talent","Loulan Siege","Elite Drill"]],C=[{name:"Sovereign Clash",schedule:[{time:"10:00",description:"opens"},{time:"14:00",description:"stamina reset"},{time:"22:30",description:"closes"}]},{name:"Naadam Fair",schedule:[{time:"10:00",description:"opens"},{time:"22:00",description:"closes"}]},{name:"Imperial Feast",schedule:[{time:"09:00",description:"opens"},{time:"21:00",description:"closes"}]},{name:"Elite Drill",schedule:[{time:"09:00",description:"opens"},{time:"21:00",description:"closes"}]},{name:"Penglai Island Domination",schedule:[{time:"10:00",description:"opens"},{time:"22:00",description:"closes"}]},{name:"Loulan Siege",schedule:[{time:"10:00",description:"opens"},{time:"20:10",description:"Palace opens"},{time:"21:30",description:"closes"}]},{name:"Jade for Beauty",schedule:[{time:"09:00",description:"opens"},{time:"21:00",description:"closes"}]},{name:"Intimacy",schedule:[{time:"23:00",description:"ends",day:3}]},{name:"Savvy",schedule:[{time:"23:00",description:"ends",day:3}]},{name:"Talent",schedule:[{time:"23:00",description:"ends",day:3}]},{name:"Go Match",schedule:[{time:"10:00",description:"opens"},{time:"21:30",description:"closes"}]},{name:"Palace Cuju",schedule:[{time:"11:00",description:"opens"},{time:"22:30",description:"closes"}]},{name:"Palace Green Ware",schedule:[{time:"10:00",description:"opens"},{time:"21:30",description:"closes"}]},{name:"Sea Fishing",schedule:[{time:"09:00",description:"opens"},{time:"21:00",description:"closes"}]},{name:"Alliance Carnival",schedule:[{time:"09:00",description:"opens"},{time:"21:00",description:"closes"}]},{name:"Scholar's Debate",schedule:[{time:"10:00",description:"opens"},{time:"21:30",description:"closes"}]}];var u={rotation:b,events:C};const F="HH:mm:ss",y="HH:mm",I="HH:mmZ",U={data(){return{serverTimeNow:"",upcomingEvents:[],eventRotation:[]}},computed:{upcomingEventsDisplay(){var e=this.upcomingEvents;return e.map(t=>this.toDisplayableEvent(t))}},mounted(){this.updateServerTime(),this.startServerTimeTick(),this.upcomingEvents=this.getUpcomingTimers(),this.eventRotation=this.getSeasonRotation()},methods:{startServerTimeTick(){setInterval(()=>{this.updateServerTime()},1e3)},getServerTime(){return c.local().toUTC(60)},updateServerTime(){let e=this.getServerTime();this.serverTimeNow=e.toFormat(F),e.second<1&&(this.upcomingEvents=this.getUpcomingTimers())},getSeasonRotation(){let e=this.getActiveEventSet(c.local().toUTC(60));return u.rotation.map((t,s)=>({events:t,isActive:s===e.eventSet}))},getActiveEventSet(e){const t=c.utc(2022,5,4).toUTC(60).minus({hour:1});let s=Math.trunc(e.diff(t).shiftTo("days").days);return{eventSet:Math.trunc(s/3)%u.rotation.length,dayOfRotation:s%3+1}},getUpcomingTimers(){let e=this.getServerTime(),s=this.getOneDayTimers(0).concat(this.getOneDayTimers(1)).filter(o=>o.time>e).sort((o,n)=>o.time.toUnixInteger()-n.time.toUnixInteger()),r=[];return s.forEach(o=>{r.every(n=>n.description!==o.description)&&r.push(o)}),r},getOneDayTimers(e){c.utc(2022,5,4).toUTC(60);let t=this.getServerTime().plus({days:e}),s=this.getActiveEventSet(t),r=u.rotation[s.eventSet].filter(n=>n!==null);return u.events.filter(n=>r.indexOf(n.name)!==-1).flatMap(n=>this.getTimersOffset(n,e)).concat(this.getStaticEvents(t)).filter(n=>n.day===void 0||n.day===s.dayOfRotation)},getStaticEvents(e){let t=[];if(t.push({time:e.plus({days:1}).set({hour:0,minute:0}),description:"Daily reset"}),t.push({time:e.set({hour:20,minute:0}),description:"Kamaitachi"}),e.day<=12){let o=u.events.filter(n=>n.name=="Sovereign Clash")[0];t=t.concat(this.getTimersDate(o,e))}t.push({time:e.set({hour:22,minute:0}),description:"Treasure Event closes",day:3});const s=c.utc(2022,6,4).toUTC(60);let r=e.diff(s,["weeks","days"]);return r.weeks%3===0&&r.days<1&&t.push({time:e.set({hour:21,minute:0}),description:"Hetu Ala opens"}),t},getTimersOffset(e,t){return e.schedule.map(s=>({time:c.fromFormat(s.time,y,{zone:"UTC+1"}).plus({days:t}),description:`${e.name} ${s.description}`,day:s.day}))},getTimersDate(e,t){return e.schedule.map(s=>({time:c.fromFormat(s.time+"+1",I).set({year:t.year,month:t.month,day:t.day}),description:`${e.name} ${s.description}`,day:s.day}))},toDisplayableEvent(e){return{serverTime:e.time.toFormat(y),localTime:e.time.setZone(f.defaultZone).toFormat(y),description:e.description,occursIn:this.toFriendlyDuration(e.time.diff(this.getServerTime(),["hours","minutes"]))}},toFriendlyDuration(e){let t="";return e.hours>0&&(e.hours===1?t+="1 hour":t+=e.hours+" hours"),e.minutes>0&&(t.length&&(t+=", "),e.minutes<=1.1?t+="1 minute":t+=Math.round(e.minutes)+" minutes"),t}}},p=e=>(S("data-v-8c0afbb2"),e=e(),_(),e),A={class:"jumbotron text-center"},P={class:"display-4 utc-clock"},x=p(()=>i("p",{class:"lead"},"Server Time (UTC + 1)",-1)),M=p(()=>i("h4",null,"Current Timers",-1)),k={class:"table table-striped"},w=p(()=>i("thead",null,[i("tr",null,[i("th",{scope:"col"},"Server Time"),i("th",{scope:"col"},"Your Time"),i("th",{scope:"col"},"Event"),i("th",{scope:"col"},"Occurs in...")])],-1)),O={id:"table-body"},R=p(()=>i("h4",null,"Season Rotation",-1)),B={class:"table table-striped-double"},H=p(()=>i("thead",null,[i("tr",null,[i("th",{scope:"col"},"Boost Event"),i("th",{scope:"col"},"Event"),i("th",{scope:"col"},"Minigame")])],-1)),N={id:"table-body"};function j(e,t,s,r,o,n){return l(),m(h,null,[i("div",A,[i("h1",P,d(o.serverTimeNow),1),x]),M,i("table",k,[w,i("tbody",O,[(l(!0),m(h,null,v(n.upcomingEventsDisplay,a=>(l(),m("tr",{key:a.name,class:E(a.description==="Daily reset"?"daily-reset":"")},[i("td",null,d(a.serverTime),1),i("td",null,d(a.localTime),1),i("td",null,d(a.description),1),i("td",null,d(a.occursIn),1)],2))),128))])]),R,i("table",B,[H,i("tbody",N,[(l(!0),m(h,null,v(o.eventRotation,a=>(l(),m("tr",{style:D({"font-weight":a.isActive?"bolder":"normal"})},[(l(!0),m(h,null,v(a.events,g=>(l(),m("td",null,d(g),1))),256))],4))),256))])])],64)}var z=T(U,[["render",j],["__scopeId","data-v-8c0afbb2"]]);export{z as default};
